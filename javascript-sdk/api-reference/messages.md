# ğŸŒ· Messages

RTM SDK å…è®¸å®¢æˆ·ç«¯ä½¿ç”¨æ¶ˆæ¯ä¼ é€’å®æ—¶ä¿¡æ¯ï¼ŒåŒ…å«å®¢æˆ·ç«¯å¸Œæœ›é€šä¿¡çš„æ•°æ®ã€‚

RTM SDK æœ‰ä¸¤ç§é¢‘é“ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ Message Channel å’Œ Stream Channelã€‚ä¸¤ç§é¢‘é“ä¸­æ¶ˆæ¯çš„ä¼ é€’æ–¹å¼å’Œéœ€è¦è°ƒç”¨çš„æ–¹æ³•ä¸åŒï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š

* Message Channelï¼šå®æ—¶é¢‘é“ï¼Œæ¶ˆæ¯é€šè¿‡é¢‘é“ä¼ é€’ï¼Œå¯æ‰©å±•æ€§å¼ºã€‚æœ¬åœ°ç”¨æˆ·å¯ä»¥è°ƒç”¨ `publish` æ–¹æ³•åœ¨é¢‘é“ä¸­å‘é€æ¶ˆæ¯ï¼Œè¿œç«¯ç”¨æˆ·å¯ä»¥è°ƒç”¨ `subscribe` æ–¹æ³•è®¢é˜…é¢‘é“å¹¶æ¥æ”¶æ¶ˆæ¯ã€‚
* Stream Channelï¼šæµä¼ è¾“é¢‘é“ï¼Œç”¨æˆ·éœ€è¦å…ˆåŠ å…¥é¢‘é“ï¼Œç„¶ååˆ›å»º Topicï¼Œæ¶ˆæ¯é€šè¿‡ Topic ä¼ é€’ã€‚æœ¬åœ°ç”¨æˆ·å¯ä»¥è°ƒç”¨ `publishTopicMessage` æ–¹æ³•åœ¨ Topic ä¸­å‘é€æ¶ˆæ¯ï¼Œè¿œç«¯ç”¨æˆ·å¯ä»¥è°ƒç”¨ `subscribeTopic` æ–¹æ³•è®¢é˜… Topic å¹¶æ¥æ”¶æ¶ˆæ¯ã€‚è¯¦è§ Topicã€‚

æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ Message Channel ä¸­æ”¶å‘æ¶ˆæ¯ã€‚

### Publish message

#### æ¥å£æè¿°

RTM SDK çš„åŸºç¡€æ˜¯å‘é€æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œä½ å¯ä»¥éšæ—¶éšåœ°å‘é¢‘é“ä¸­å‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä¼šåœ¨ 100 æ¯«ç§’å†…ä¼ é€’åˆ°ä»»ä½•åœ°æ–¹ã€‚ä½ å¯ä»¥ç›´æ¥è°ƒç”¨ `publish` æ–¹æ³•å‘é¢‘é“çš„æ‰€æœ‰è®¢é˜…è€…å‘é€æ¶ˆæ¯ã€‚å³ä½¿æ²¡æœ‰è®¢é˜…é¢‘é“ï¼Œä¹Ÿèƒ½åœ¨é¢‘é“ä¸­å‘é€æ¶ˆæ¯ã€‚

æ³¨æ„ï¼š

* è°ƒç”¨è¯¥æ–¹æ³•å‰ï¼Œä½ éœ€è¦åœ¨åˆå§‹åŒ–æ—¶å°† `ssl` å‚æ•°è®¾ç½®ä¸º `true`ï¼Œå¼€å¯ SSL/TLS åŠ å¯†åŠŸèƒ½ã€‚
* ä»¥ä¸‹åšæ³•å¯æœ‰æ•ˆæå‡æ¶ˆæ¯æ”¶å‘çš„å¯é æ€§ï¼š
  * ä»¥ä¸²è¡Œçš„æ–¹å¼å‘é€æ¶ˆæ¯ã€‚æ¯æ¬¡å‘é€å‰å…ˆæ£€æŸ¥ä¸Šä¸€æ¡æ¶ˆæ¯æ˜¯å¦æˆåŠŸå‘é€ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼›å¦‚æœä¸æˆåŠŸï¼Œåˆ™é‡å‘ä¸Šä¸€æ¡æ¶ˆæ¯ã€‚
  * æ¶ˆæ¯è´Ÿè½½é™åˆ¶åœ¨ 1 KB ä»¥å†…ï¼Œå¦åˆ™å‘é€ä¼šå¤±è´¥ã€‚
  * å•ä¸ªå®¢æˆ·ç«¯å‘å•ä¸ªé¢‘é“å‘é€æ¶ˆæ¯çš„é€Ÿç‡ä¸Šé™ä¸º 60 QPSã€‚å¦‚æœå‘é€é€Ÿç‡è¶…é™ï¼Œå°†ä¼šæœ‰éƒ¨åˆ†æ¶ˆæ¯è¢«ä¸¢å¼ƒã€‚åœ¨æ»¡è¶³è¦æ±‚çš„æƒ…å†µä¸‹ï¼Œé€Ÿç‡è¶Šä½è¶Šå¥½ã€‚
* RTM ä¸ä¿è¯æ‰€æœ‰è®¢é˜…è€…æ¥æ”¶åˆ°æ¶ˆæ¯çš„é¡ºåºä¸å‘é€è€…å‘é€æ¶ˆæ¯çš„é¡ºåºä¿æŒä¸€è‡´ã€‚å¦‚æœä½ æƒ³è¦ä¿éšœæ¶ˆæ¯æœ‰åºæ€§ï¼Œå£°ç½‘å»ºè®®ä½ åœ¨æ¶ˆæ¯è´Ÿè½½ä¸­è‡ªå®šä¹‰æ¶ˆæ¯åºå·ã€‚

#### æ¥å£æ–¹æ³•

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è°ƒç”¨ `publish` æ–¹æ³•ï¼š

```javascript
rtm.publish(
  {
    msChannel: "my_channel",
    message: {"text": "Hello World!"}
  },
  function(status, response) {
    console.log(status);
    console.log(response);
  }
);
```

|  Parameter  |   Type   | Required | Default |              Description              |
| :---------: | :------: | :------: | :-----: | :-----------------------------------: |
|  `message`  |  Object  |    Yes   |    /    | æ¶ˆæ¯è´Ÿè½½ã€‚æ”¯æŒä»»æ„ JSON å¯åºåˆ—åŒ–æ•°æ®ï¼ŒåŒ…å«å¯¹è±¡ã€æ•°ç»„ã€æ•´æ•°å’Œå­—ç¬¦ä¸²ã€‚ |
| `msChannel` |  String  |    Yes   |    /    |     æŒ‡å®šæ¶ˆæ¯å‘é€çš„é¢‘é“åç§°ã€‚åŒä¸€æ—¶é—´ä»…æ”¯æŒå‘ä¸€ä¸ªé¢‘é“å‘é€æ¶ˆæ¯ã€‚     |
|    `meta`   |  Object  | Optional |    /    |                  å…ƒæ•°æ®ã€‚                 |
|  `callback` | Function | Optional |    /    |                 å›è°ƒå‡½æ•°ã€‚                 |

#### åŸºæœ¬ç”¨æ³•

ç¤ºä¾‹ 1ï¼šå‘æŒ‡å®šé¢‘é“å‘é€ String æ¶ˆæ¯

```javascript
rtm.publish(
    {
        message: {
            such: 'object'
        },
        msChannel: 'my_channel',
        meta: {
            "cool": "meta"
        }   // publish extra meta with the request
    },
    function (status, response) {
        if (status.error) {
            // handle error
            console.log(status)
        } else {
            console.log("message Published w/ timetoken", response.timetoken)
        }
    }
);
```

ç¤ºä¾‹ 2ï¼šå‘æŒ‡å®šé¢‘é“å‘é€ JSON åºåˆ—åŒ–æ¶ˆæ¯

```javascript
var newMessage = {
    text: 'Hi There!'
}
rtm.publish(
    {
        message: newMessage,
        msChannel: 'my_channel'
    },
    function(status, response) {
        if (status.error) {
            console.log("publishing failed w/ status: ", status);
        } else {
            console.log("message published w/ server response: ", response);
        }
    }
);
```

#### è¿”å›å€¼

```javascript
[200,[1,"Sent","14375189629170609"]]
```

### Receive message

RTM æä¾›æ¶ˆæ¯ã€çŠ¶æ€ã€äº‹ä»¶å˜æ›´ç­‰ä¿¡æ¯çš„äº‹ä»¶é€šçŸ¥ã€‚é€šè¿‡è®¾ç½® Event Listenerï¼Œä½ å¯ä»¥æ¥æ”¶å·²è®¢é˜…é¢‘é“ä¸­çš„æ¶ˆæ¯ã€‚

å…³äºå¦‚ä½•æ·»åŠ å’Œè®¾ç½® Listenerï¼Œå¯ä»¥å‚è€ƒ Event Listeners ç« èŠ‚ã€‚
